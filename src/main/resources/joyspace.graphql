schema {
    query: QueryType
    mutation: MutationType
}

#查询
type QueryType {
    #根据id查找自助打印机
    printStation(printStationId: Int!): PrintStation

    #查找指定自助机的待打印订单
    getPrintOrder(printStationId: Int!, idAfter: Int!): PrintOrder
}

#增删改操作
type MutationType {
    #用户登录
    login(userName: String, phoneNumber: String, password: String!) : LoginRequestResult!

    #发送注册验证码
    sendRegVerifyCode(phoneNumber: String!) : RequestResult!

    #用户注册
    userRegister(userName: String!, password: String!, phoneNumber: String!, verifyCode: String!, email: String) : RequestResult!

    #更新订单状态为已下载
    printOrderDownloaded(printStationId: Int!, printOrderId: Int!) : RequestResult!

    #更新订单状态为已打印
    printOrderPrinted(printStationId: Int!, printOrderId: Int!) : RequestResult!
}

#请求的结果的通用类型
type RequestResult{
    #结果代码
    #0: 成功
    #1: 手机号码已经注册过
    #2: 用户名已经注册过
    #3: 无效或过期的验证码
    #4: 请求太频繁(请等待60秒以后再试)
    #5: 发送验证码失败
    #100: 服务器错误
    result: Int!

    #结果的描述 (语言: zh, en ...)
    description(language: String) : String!
}

#登录请求结果
type LoginRequestResult {
    #结果代码
    #0: 成功
    #1: 手机号或密码错误
    #2: 用户名或密码错误
    #3: 缺少用户名或手机号
    result: Int!

    #结果的描述 (语言: zh, en ...)
    description(language: String) : String

    #登录sessionId
    sessionId: String

    #登录用户信息
    userInfo: LoginUser
}


#登录用户
type LoginUser {
    #手机号码
    phone: String!

    #用户名
    userName: String

    #邮件地址
    email: String
}

#投放商
type Company {
    name: String!
}

#投放地点
type Position {
    name: String!

    #地址
    address: String!

    #经度
    longitude: Float!

    #纬度
    latitude: Float!

    #此地点的自助机列表
    printStations: [PrintStation!]
}

#产品
type Product {
    id: Int!
    name: String!
    type: ProductType!

    #宽度（毫米）
    width: Float!

    #高度（毫米）
    height: Float!

    #最少需要照片张数
    imageRequired: Int!

    #描述
    remark: String

    #产品价格（单位是分）
    price: Int

    #小缩略图url
    thumbnailUrl: [String!]

    #展示图url
    previewUrl: [String!]
}

#产品类型
enum ProductType {
    #普通照片
    PHOTO

    #证件照
    ID_PHOTO

    #模板拼图
    TEMPLATE
}

#自助打印机
type PrintStation {
    #投放地点
    position: Position!

    #属于哪个投放商
    company: Company!

    #支持的产品列表
    products: [Product!]
}

#用户上传图片
type UserImageFile {
    #类型
    type: String!

    #文件名
    fileName: String!

    #宽度(像素)
    width: Int!

    #高度(像素)
    height: Int!

    #下载url
    url: String!
}

#订单项目
type PrintOrderItem {
    #打印份数
    copies: Int!

    #图片文件
    imageFiles: [UserImageFile!]

    #产品
    product: Product!
}

#订单
type PrintOrder {
    id: Int!
    printOrderItems: [PrintOrderItem!]
    state: Int!
}
